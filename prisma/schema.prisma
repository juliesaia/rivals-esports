// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

model Player {
  id Int @id @default(autoincrement())
  name String 
  smashggid String @unique
  pronouns String?
  socials Social[]
  rankings Ranking[]
  tournaments Tournament[]
  sets Set[]
  wins Set[] @relation("wins")
  losses Set[] @relation("losses")
  games Game[]
  gameWins Game[] @relation("gameWins")
  gameLosses Game[] @relation("gameLosses")
  standings Standing[]
  favoriteCharacter String?
}

model Ranking {
  id Int @id @default(autoincrement())
  season Int
  rank Int
  player Player @relation(fields: [playerid], references: [id])
  playerid Int
}

model Tournament {
  id Int @id @default(autoincrement())
  season Int
  entrants Player[]
  sets Set[]
  standings Standing[]
  slug String @unique
  eventSlug String @unique
  name String @unique
  online Boolean
  state String?
  city String?
  profileImage String?
  bannerImage String?
  startAt Int?
  endAt Int?
  timezone String?
}

model Standing {
  id Int @id @default(autoincrement())
  placement Int?
  seed Int?
  player Player @relation(fields: [playerid], references: [id])
  playerid Int
  tournament Tournament @relation(fields: [tournamentid], references: [id])
  tournamentid Int
}

model Set {
  id Int @id @default(autoincrement())
  smashggid Int @unique
  players Player[]
  games Game[]
  winner Player @relation("wins", fields: [winnerid], references: [id])
  winnerid Int
  loser Player @relation("losses", fields: [loserid], references: [id])
  loserid Int
  tournament Tournament @relation(fields: [tournamentid], references: [id])
  tournamentid Int
  order Int
  uf Int
  winnerGameCount Int
  loserGameCount Int
  phase String?
  fullRoundText String?
}

model Game {
  id Int @id @default(autoincrement())
  players Player[]
  winner Player @relation("gameWins", fields: [winnerid], references: [id])
  winnerid Int
  loser Player @relation("gameLosses", fields: [loserid], references: [id])
  loserid Int
  set Set @relation(fields: [setid], references: [id])
  setid Int
  gameNumber Int
  winnerChar String?
  loserChar String?
}

model Social {
  id Int @id @default(autoincrement())
  player Player @relation(fields: [playerid], references: [id])
  type String
  externalUsername String?
  playerid Int
}

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["clientExtensions", "filteredRelationCount"]
}

datasource db {
  provider = "sqlite"
  url      = "file:/home/cheesypotato/rivals-esports/prisma/dev.db"
  // provider = "mysql"
  // url      = env("DATABASE_URL")
}
