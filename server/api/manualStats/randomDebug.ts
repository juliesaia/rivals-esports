import { prisma } from "../../prisma";
import { top50 } from "~~/server/lists/top50";

export default defineEventHandler(async (event) => {
    const uniqueIDs = [
        ...new Set(
            Object.values(top50)
                .flat()
                .map((x) => x.smashggID)
        ),
    ];
    const toReturn = [];

    for (const id of uniqueIDs) {
        const playerName = Object.values(top50)
            .flat()
            .reverse()
            .find((x) => x.smashggID === id).name;
        const allRankings = Object.values(top50)
            .flat()
            .filter((x) => x.smashggID === id)
            .map((x) => x.ranking);
        toReturn.push({
            name: playerName,
            smashggID: id,
            rankings: allRankings,
            timesRanked: allRankings.length,
            averageRank:
                allRankings.reduce((a, b) => a + b) / allRankings.length,
        });
    }

    return toReturn.sort((a, b) => a.averageRank - b.averageRank);
});

const playerList = [
    "FullStream",
    "MrLz",
    "Ralph",
    "CakeAssault",
    "Arcanine",
    "Kaos",
    "AZCards",
    "LBO",
    "MSB",
    "Kisuno",
    "DolphinBrick",
    "TheFailWhale",
    "Turquoise",
    "Handbuttt",
    "PikaThePikachu",
    "ProDoubleSushi",
    "Kenneth",
    "Atma",
    "TurtleBox",
    "GracefulKnight",
    "RiskyCB",
    "Windows",
    "Aurecia",
    "TheEvets",
    "TheDuoDesign",
    "Ceztellz",
    "Protagify",
    "Geqqo",
    "Tandori",
    "Guyron",
    "Dunk",
    "Penguin",
    "Sino",
    "Cupz",
    "JCOnyx",
    "Alexis",
    "Jorane",
    "Bumblebomb",
    "Quote_a",
    "MiNi",
    "Jesier",
    "TheBestAdamCarra",
    "GamingClan",
    "Allergic to Bullets",
    "Mephiles",
    "Renzo",
    "Nevereatcars",
    "SisterEden",
    "Mang0",
    "Solar",
    "Heyodogo",
    "Lord Bagel",
    "SBS",
    "ZeeBee",
    "Dynla",
    "Gaming",
    "Risky",
    "Mugi",
    "geck-0",
    "Dam Danny",
    "Shadow",
    "Adi",
    "hoppyKnitz",
    "Sparx21",
    "ITS A CAT",
    "Corkxx",
    "Seggo",
    "sawsebawse",
    "WooF",
    "Pepe",
    "Skittles",
    "Vaporeon",
    "yesdefinitely",
    "You",
    "MattyIce",
    "Blue",
    "Bullets",
    "Chompers",
    "Hatz",
    "DosRogers",
    "Theomach",
    "Tapscott",
    "DankRamenBoy",
    "Randle",
    "Autumn",
    "culex",
    "Lucius",
    "Xaro",
    "Nero",
    "Jackie Peanuts",
    "Dr Nitronio",
    "Shotti",
    "Akashi",
    "Cheesedog",
    "ProuxEXE",
    "Stroder",
    "Forrest",
    "Backpack",
    "Guard",
    "Bagel",
    "Lattim",
    "Kobra",
    "PrimeTime",
    "O-Gazm",
    "Giga Bowser",
    "starbos",
    "Kruz",
    "Plastic Dinos",
    "CheesyPotato",
    "Levin",
    "Marx",
    "Kaaeru",
    "Spook",
    "Danzello",
    "Junuh",
    "Nexplosion",
    "kusi",
    "Squanto",
    "Halite",
    "Flarey",
    "hoppyknitz",
    "1stDan",
    "HKP",
    "Soulrifle211",
    "Mentos",
    "Ceroas",
    "Buster",
    "Nbad",
    "elpe",
    "Zora",
    "Death By Hugs",
    "Wai",
    "Mr. Olsen",
    "darai",
    "CRSDCrusader",
    "Bookworm",
    "Menace13",
    "Oogapooki",
    "Mystic Deer",
    "OoDaShadowTheft",
    "Zachial",
    "Vivi",
    "BioBirb",
    "Qapples",
    "TacocaT",
    "Crusader",
    "Koda",
    "Codek",
    "Mystery Sol",
    "ZoraTK",
    "Spyker",
    "Tanko",
    "OoDa",
    "Ahntye",
    "Mr. Mutton",
    "Yeggy",
    "Sawtooth",
    "Syzygy",
    "Rift",
    "Frenchyy",
    "AdamGMAJ",
];
